<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="icon" href="/assets/favicon/favicon_01/favicon-16x16.png?v=2.3.0" type="image/png" sizes="16x16"><link rel="icon" href="/assets/favicon/favicon_01/favicon-32x32.png?v=2.3.0" type="image/png" sizes="32x32"><meta name="description" content="Conditional Channel Gated Networks for Task-Aware Continual Learning Davide Abati, Jakub Tomczak, Tijmen Blankevoort, Simone Calderara, Rita Cucchiara, Babak Ehteshami Bejnordi CVPR 2020  [paper] [tal">
<meta property="og:type" content="article">
<meta property="og:title" content="Paper Note: Conditional Channel Gated Networks for Task-Aware Continual Learning">
<meta property="og:url" content="https://hello-liuyang.com/2021/01/11/Paper-Note-Conditional-Channel-Gated-Networks-for-Task-Aware-Continual-Learning/index.html">
<meta property="og:site_name" content="Hello, Stranger">
<meta property="og:description" content="Conditional Channel Gated Networks for Task-Aware Continual Learning Davide Abati, Jakub Tomczak, Tijmen Blankevoort, Simone Calderara, Rita Cucchiara, Babak Ehteshami Bejnordi CVPR 2020  [paper] [tal">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://hello-liuyang.com/2021/01/11/Paper-Note-Conditional-Channel-Gated-Networks-for-Task-Aware-Continual-Learning/01.png">
<meta property="og:image" content="https://hello-liuyang.com/2021/01/11/Paper-Note-Conditional-Channel-Gated-Networks-for-Task-Aware-Continual-Learning/02.png">
<meta property="og:image" content="https://hello-liuyang.com/2021/01/11/Paper-Note-Conditional-Channel-Gated-Networks-for-Task-Aware-Continual-Learning/03.png">
<meta property="og:image" content="https://hello-liuyang.com/2021/01/11/Paper-Note-Conditional-Channel-Gated-Networks-for-Task-Aware-Continual-Learning/05.png">
<meta property="og:image" content="https://hello-liuyang.com/2021/01/11/Paper-Note-Conditional-Channel-Gated-Networks-for-Task-Aware-Continual-Learning/04.png">
<meta property="og:image" content="https://hello-liuyang.com/2021/01/11/Paper-Note-Conditional-Channel-Gated-Networks-for-Task-Aware-Continual-Learning/tab2.png">
<meta property="og:image" content="https://hello-liuyang.com/2021/01/11/Paper-Note-Conditional-Channel-Gated-Networks-for-Task-Aware-Continual-Learning/fig5.png">
<meta property="og:image" content="https://hello-liuyang.com/2021/01/11/Paper-Note-Conditional-Channel-Gated-Networks-for-Task-Aware-Continual-Learning/fig6.png">
<meta property="og:image" content="https://hello-liuyang.com/2021/01/11/Paper-Note-Conditional-Channel-Gated-Networks-for-Task-Aware-Continual-Learning/tab3.png">
<meta property="article:published_time" content="2021-01-11T12:09:16.000Z">
<meta property="article:modified_time" content="2021-01-17T07:10:05.333Z">
<meta property="article:author" content="liuyang-70d12d">
<meta property="article:tag" content="Continual Learning">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://hello-liuyang.com/2021/01/11/Paper-Note-Conditional-Channel-Gated-Networks-for-Task-Aware-Continual-Learning/01.png"><title>Paper Note: Conditional Channel Gated Networks for Task-Aware Continual Learning | Hello, Stranger</title><link ref="canonical" href="https://hello-liuyang.com/2021/01/11/Paper-Note-Conditional-Channel-Gated-Networks-for-Task-Aware-Continual-Learning/"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.12.1/css/all.min.css" type="text/css"><link rel="stylesheet" href="/css/index.css?v=2.3.0"><script>var Stun = window.Stun || {};
var CONFIG = {
  root: '/',
  algolia: undefined,
  assistSearch: undefined,
  fontIcon: {"prompt":{"success":"fas fa-check-circle","info":"fas fa-arrow-circle-right","warning":"fas fa-exclamation-circle","error":"fas fa-times-circle"},"copyBtn":"fas fa-copy"},
  sidebar: {"offsetTop":"20px","tocMaxDepth":6},
  header: {"enable":true,"showOnPost":false,"scrollDownIcon":true},
  postWidget: {"endText":true},
  nightMode: {"enable":true},
  back2top: {"enable":true},
  codeblock: {"style":"default","highlight":"light","wordWrap":false},
  reward: false,
  fancybox: false,
  zoomImage: {"gapAside":"20px"},
  galleryWaterfall: undefined,
  lazyload: false,
  pjax: undefined,
  externalLink: {"icon":{"enable":true,"name":"fas fa-external-link-alt"}},
  shortcuts: undefined,
  prompt: {"copyButton":"Copy","copySuccess":"Copy Success","copyError":"Copy Error"},
  sourcePath: {"js":"js","css":"css","images":"images"},
};

window.CONFIG = CONFIG;</script><meta name="generator" content="Hexo 5.2.0"></head><body><div class="container" id="container"><header class="header" id="header"><div class="header-inner header-inner--height header-inner--bgcolor"><nav class="header-nav header-nav--sticky"><div class="header-nav-inner"><div class="header-nav-menubtn"><i class="fas fa-bars"></i></div><div class="header-nav-menu"><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/"><span class="header-nav-menu-item__icon"><i class="fas fa-home"></i></span><span class="header-nav-menu-item__text">Home</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/archives/"><span class="header-nav-menu-item__icon"><i class="fas fa-folder-open"></i></span><span class="header-nav-menu-item__text">Archives</span></a></div><div class="header-nav-menu-item"><a class="header-nav-menu-item__link" href="/tags/"><span class="header-nav-menu-item__icon"><i class="fas fa-tags"></i></span><span class="header-nav-menu-item__text">Tags</span></a></div></div><div class="header-nav-mode"><div class="mode"><div class="mode-track"><span class="mode-track-moon"></span><span class="mode-track-sun"></span></div><div class="mode-thumb"></div></div></div></div></nav></div></header><main class="main" id="main"><div class="main-inner"><div class="content-wrap" id="content-wrap"><div class="content" id="content"><!-- Just used to judge whether it is an article page--><div id="is-post"></div><div class="post"><header class="post-header"><h1 class="post-title">Paper Note: Conditional Channel Gated Networks for Task-Aware Continual Learning</h1><div class="post-meta"><span class="post-meta-item post-meta-item--createtime"><span class="post-meta-item__icon"><i class="far fa-calendar-plus"></i></span><span class="post-meta-item__info">Created</span><span class="post-meta-item__value">2021-01-11</span></span><span class="post-meta-item post-meta-item--updatetime"><span class="post-meta-item__icon"><i class="far fa-calendar-check"></i></span><span class="post-meta-item__info">Updated</span><span class="post-meta-item__value">2021-01-17</span></span><span class="post-meta-item post-meta-item--visitors"><span class="post-meta-item__icon"><i class="fas fa-eye"></i></span><span class="post-meta-item__info">Visited</span><span class="post-meta-item__value" id="busuanzi_value_page_pv"></span></span></div></header><div class="post-body"><p><font face="Adobe Caslon Pro"><strong>Conditional Channel Gated Networks for Task-Aware Continual Learning</strong></font></p>
<p><font face="Adobe Caslon Pro"><em>Davide Abati, Jakub Tomczak, Tijmen Blankevoort, Simone Calderara, Rita Cucchiara, Babak Ehteshami Bejnordi</em></font></p>
<p><font face="Adobe Caslon Pro"><em>CVPR 2020</em> </font></p>
<p><font face="Adobe Caslon Pro">[<span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://arxiv.org/abs/2004.00070">paper</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>]</font> <font face="Adobe Caslon Pro">[<span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=Qp2g-CzlxjQ&amp;ab_channel=ComputerVisionFoundationVideos">talk</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>]</font> <font face="Adobe Caslon Pro">[<span class="exturl"><a class="exturl__link" target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=k0kMx4BFLmI&amp;ab_channel=2d3d.ai">lecture</a><span class="exturl__icon"><i class="fas fa-external-link-alt"></i></span></span>]</font></p>
<a id="more"></a>

        <h2 id="font-faceadobe-caslon-proabstractfont">
          <a href="#font-faceadobe-caslon-proabstractfont" class="heading-link"><i class="fas fa-link"></i></a>Abstract</h2>
      
<p><font face="Adobe Caslon Pro">当针对一系列学习问题进行优化时，卷积神经网络会遭遇“灾难性遗忘”：当它们满足当前训练样例的目标时，它们在先前任务上的表现将急剧下降。在这项工作中，我们引入了一个新框架，通过条件计算（conditional computation）解决这个问题。我们为每个卷积层添加了 task-specific gating modules，用来选择对于给定输入使用哪些 filters。</font></p>
<p><font face="Adobe Caslon Pro">依照这种方法，我们实现了两个吸引人的特性。首先，gates 的执行模式允许识别和保护重要的 filters，从而确保先前学习的任务的模型性能不会损失。其次，通过使用稀疏化目标，我们可以减少所选用的 kernels 的数目，从而保留足够的模型容量来消化新任务。</font></p>
<p><font face="Adobe Caslon Pro">现有的解决方案属于 task incremental learning 的范畴。但是，在许多实际情况下，在 inference 的时候可能无法知晓样例是属于哪个任务。因此，我们另外引入了一个任务分类器，该分类器可预测每个样例的任务标签，以此解决在 inference 时不能知道样例属于哪个任务的情况（也就是将 task incremental 的方法改造成了 class incremental 的方法）。</font></p>
<p><font face="Adobe Caslon Pro">我们在四个持续学习数据集上验证了我们的想法。结果表明，无论是否存在 task oracle（即inference时样例的任务标签），我们的模型始终优于现有方法。值得注意的是，在 <em>Split SVHN</em> 和 <em>Imagenet-50</em> 数据集上，我们的模型相比于所对比的方法，精度提高了23.98％和17.42％。</font></p>

        <h2 id="font-faceadobe-caslon-pro1-introductionfont">
          <a href="#font-faceadobe-caslon-pro1-introductionfont" class="heading-link"><i class="fas fa-link"></i></a>1. Introduction</h2>
      
<p><font face="Adobe Caslon Pro">机器学习和深度学习的模型通常通过对数据进行采样，然后进行离线训练，训练时的数据样本的分布往往与测试时的分布独立。但是，当在实际环境中进行在线训练时，模型可能会遇到许多任务，这些任务是以一系列连续的活动的形式呈现，而在此之前对于它们之间的关系或持续时长则一无所知。这种挑战通常出现在 robotics[2]，强化学习[29]，视觉系统[26]等中（参见[7]的第4章）。在这种情况下，深度学习模型会遭遇“灾难性遗忘”[23，9]，这意味着它们会丢弃先前获得的知识以适应当前的任务。根本原因是，在学习新任务时，模型会覆盖对先前任务而言至关重要的参数。</font></p>
<p><font face="Adobe Caslon Pro">持续学习 continual learning（也称为终身学习 lifelong learning 或增量学习 incremental learning）解决了上述问题[7]。一般文献中考虑的典型场景是模型去学习互不相干（disjoint）的一个接一个的分类问题。持续学习一般可以分为 task-incremental 的和 class-incremental 的。现有的方法采用了不同的策略来减轻灾难性的遗忘，例如 memory buffers [27, 18]，知识蒸馏[17]，synaptic consolidation [14]和 parameters masking [21, 32]。然而，最近的证据表明，如果在测试时任务标签不可知的情况下，即使对于简单的数据集，现有的解决方案也会失败[35]。</font></p>
<p><font face="Adobe Caslon Pro">本文介绍了一种基于条件计算（conditional-computing）的解决方案，以解决任务增量（task-incremental）学习和类（class-incremental）增量学习问题。具体来说，我们的框架依赖于单独的特定于任务的分类头（亦即：<em>multi-head</em> architecture），并且在（共享）的特征提取器的每一层中均采用通道门控技术（channel-gating）[6, 3]。为此，我们引入了特定于任务的选通模块（task-dedicated gating modules），该模块动态选择要在 input feature map 上应用的 filters。伴之以鼓励使用更少 units 的稀疏化目标，该策略能够依照任务来选择使用哪些 filters，并且可以很容易地知道权重对于当前任务的重要程度。在学习新任务时，已经被使用的权重将被冻结，但是选通模块可以动态选择使用还是丢弃它们。相反，先前任务从未使用过的 units 将被重新初始化，并可以用于获取新知识。此过程可防止忘记过去的任务，并在前向传播时节省大量计算量。此外，我们通过引入任务分类器来避免在推理时对任务标签的需要，该任务分类器能够为类预测选择使用哪个分类头。我们在相同的增量学习约束下，一起训练任务分类器与分类头。为了减轻任务分类方面的遗忘，我们依赖于 episodic memories 和 generative memories 等样例重放的方法。在这两种情况下，我们都展示了在任务级别执行 rehearsal 的好处，与之前在类级别执行的重放方法相反[27, 5]。据我们所知，这是第一项在类增量学习环境中进行监督任务预测的工作。 </font></p>
<p><font face="Adobe Caslon Pro">我们对四个难度越来越大的数据集进行了广泛的实验，既包括在测试时有任务标签的情况，也包括在测试时无任务标签的情况。我们的结果表明，在有任务标签的情况下，我们的模型可以有效地避免遗忘问题，并且其性能与 SOTA 相似或更好。在没有任务标签的情况下，我们始终优于所对比的方法（competing methods）。 </font></p>

        <h2 id="font-faceadobe-caslon-pro2-related-workfont">
          <a href="#font-faceadobe-caslon-pro2-related-workfont" class="heading-link"><i class="fas fa-link"></i></a>2. Related work</h2>
      
<p><font face="Adobe Caslon Pro"><strong>Continual learning.</strong> “灾难性遗忘”是神经网络中一个众所周知的问题[23]。 缓解该问题的早期方法包括 orthogonal representation learning 和 replay of prior samples [9]。持续学习领域已经广泛使用深度神经网络。Progressive Neural Networks [30] 通过为每个新任务引入一组新的参数来解决遗忘问题，但代价是可扩展性有限。另一种影响广泛的方法是使用知识蒸馏，即在学习新任务时把模型过去的参数化作为参考[17]。</font></p>
<p><font face="Adobe Caslon Pro">最近出现了 <em>Consolidation</em> 方法，其重点是确定对于先前任务而言至关重要的权重，并防止在学习新任务期间对其进行过大的改变。每个参数的相关性/重要性估计可以通过Fisher Information Matrix[14]，损失函数梯度的路径积分[39]，梯度幅度[1]和贝叶斯神经网络中的后验不确定性估计[25]来实现。</font></p>
<p><font face="Adobe Caslon Pro">其他流行的 Consolidation 方法依赖于 binaray masks 的估计，该估计将每个任务直接映射到负责该任务的参数集。可以通过随机分配 [22]，剪枝 [21]或梯度下降 [20，32] 来实现对masks的估计。但是，现有的基于 mask 的方法只能在提供了任务标签的情况下运行。我们的工作类似于上述模型，但有两个基本区别：i）我们的 binary masks (gates) 是动态生成的，并且依赖于网络输入；ii）我们提出包含任务分类器的 mask-based 的方法来实现类增量学习。</font></p>
<p><font face="Adobe Caslon Pro">有几种模型允许访问有限容量的内存缓冲区（即：<em>episodic</em> memory），其中保留有先前任务中的样例。一种流行的方法是 iCaRL [27]，它可以将类原型（class prototypes）计算为存储样例的平均特征表示，并以最近邻的方式对测试样例进行分类。[18, 5, 28] 提出，调整在当前批次上计算出的梯度的更新方向，使之对存储的样例无破坏性影响。这样的目标可以通过受限优化问题 [18，5] 或采用元学习算法[28] 来实现。与此不同的，<em>generative</em> memories 不依赖于任何真实样例的重放，而是依赖于生成模型，从中可以有效采样过去任务的伪造样例[34, 38, 26]。在本文中，我们也依赖于 episodic memories 或 generative memories 来应对类增量学习的情况。但是，我们仅在避免任务预测的灾难性遗忘时使用 replay，也以此避免了对于特定于任务的分类头的更新。 </font></p>
<p><font face="Adobe Caslon Pro"><strong>Conditional computation.</strong> 条件计算是希望深度神经网络的架构能够适应于给定的输入。尽管第一项工作已应用于语言建模[33]，但仍有几项工作将此概念应用于计算机视觉问题。在这方面，现有技术采用 binary gates 来决定是否执行或跳过某个计算块。这样的 gates 可以 drop 掉整个 residual blocks [36, 37]或是层内的特定 units [6, 3]。在我们的工作中，我们使用后一种方法，学习一组特定于任务的选通模块，以选择将哪些 kernels 应用于给定的输入。据我们所知，这是数据依赖型通道门控（data-dependent channel-gating）在持续学习中的首次应用。 </font></p>

        <h2 id="font-faceadobe-caslon-pro3-modelfont">
          <a href="#font-faceadobe-caslon-pro3-modelfont" class="heading-link"><i class="fas fa-link"></i></a>3. Model</h2>
      

        <h3 id="font-faceadobe-caslon-pro31-problem-setting-and-objectivefont">
          <a href="#font-faceadobe-caslon-pro31-problem-setting-and-objectivefont" class="heading-link"><i class="fas fa-link"></i></a>3.1 Problem setting and objective</h3>
      
<p>我们有一个参数模型（比如：神经网络），称作 <em>backbone</em> 或 <em>learner</em> 网络，该网络将要去学习一系列的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span></span> 个任务，即：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="script">T</mi><mo>=</mo><mo stretchy="false">{</mo><msub><mi>T</mi><mn>1</mn></msub><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>T</mi><mi>N</mi></msub><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">\mathcal{T}=\{T_1,...,T_N\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.25417em;">T</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.10903em;">N</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span>。每个任务 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>T</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">T_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 是一个分类问题，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>T</mi><mi>i</mi></msub><mo>=</mo><mo stretchy="false">{</mo><msub><mi>x</mi><mi>j</mi></msub><mo separator="true">,</mo><msub><mi>y</mi><mi>j</mi></msub><msubsup><mo stretchy="false">}</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><msub><mi>n</mi><mi>i</mi></msub></msubsup></mrow><annotation encoding="application/x-tex">T_i=\{x_j,y_j\}_{j=1}^{n_i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.162972em;vertical-align:-0.412972em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose"><span class="mclose">}</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.746292em;"><span style="top:-2.4231360000000004em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.1449000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3280857142857143em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.412972em;"><span></span></span></span></span></span></span></span></span></span> ，其中 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>x</mi><mi>j</mi></msub><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mi>m</mi></msup></mrow><annotation encoding="application/x-tex">x_j \in \mathbb{R}^m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8252079999999999em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.68889em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathbb">R</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.664392em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">m</span></span></span></span></span></span></span></span></span></span></span>，并且 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>y</mi><mi>j</mi></msub><mo>∈</mo><mo stretchy="false">{</mo><mn>1</mn><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msub><mi>C</mi><mi>i</mi></msub><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">y_j\in\{1,...,C_i\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8252079999999999em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.07153em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span>。</p>
<p><font face="Adobe Caslon Pro">task-incremental setting 是对下面的式子进行优化：</font></p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><munder><mo><mi>max</mi><mo>⁡</mo></mo><mi>θ</mi></munder><mtext> </mtext><msub><mi mathvariant="double-struck">E</mi><mrow><mi>t</mi><mo>∼</mo><mi mathvariant="script">T</mi></mrow></msub><mo fence="false">[</mo><msub><mi mathvariant="double-struck">E</mi><mrow><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>∼</mo><msub><mi>T</mi><mi>t</mi></msub></mrow></msub><mo fence="false">[</mo><mi>log</mi><mo>⁡</mo><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>y</mi><mi mathvariant="normal">∣</mi><mi>x</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo fence="false">]</mo><mo fence="false">]</mo><mspace width="2em"><mspace width="2em"><mo stretchy="false">(</mo><mn>1</mn><mo stretchy="false">)</mo></mspace></mspace></mrow><annotation encoding="application/x-tex">\max_\theta\ \mathbb{E}_{t\sim\mathcal{T}}\Big[
\mathbb{E}_{(x,y)\sim T_t}\big[
\log p_\theta(y|x,t)
\big]
\Big]
\qquad\qquad(1)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.902108em;vertical-align:-0.752108em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.43055999999999994em;"><span style="top:-2.047892em;margin-left:0em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span><span class="mop">max</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.752108em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace"> </span><span class="mord"><span class="mord"><span class="mord mathbb">E</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mrel mtight">∼</span><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right:0.25417em;">T</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="delimsizing size2">[</span></span><span class="mord"><span class="mord"><span class="mord mathbb">E</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">x</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span><span class="mclose mtight">)</span><span class="mrel mtight">∼</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.29634285714285713em;"><span style="top:-2.357em;margin-left:-0.13889em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class="mord"><span class="delimsizing size1">[</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord">∣</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">t</span><span class="mclose">)</span><span class="mord"><span class="delimsizing size1">]</span></span><span class="mord"><span class="delimsizing size2">]</span></span><span class="mspace" style="margin-right:2em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mclose">)</span></span></span></span></span></p>
<p><font face="Adobe Caslon Pro">其中 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>θ</mi></mrow><annotation encoding="application/x-tex">\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span></span></span></span> 为 learner network 的参数，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo separator="true">,</mo><mi>t</mi></mrow><annotation encoding="application/x-tex">x,y,t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.80952em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">t</span></span></span></span> 分别为每个样例的 observation，标签以及所对应的任务。这样的最大化问题受到持续学习的约束：当模型顺次观察任务时，Eq.1 中外层期望难以计算或近似。值得注意的是，该 setting 需要假设每个样例所属的任务的标签在训练和测试阶段都是已知的。在实际中，可以利用这些信息来隔离分类器的相关输出单元，从而防止通过同一 softmax 层（<em>multi-head</em>）的属于不同任务的类之间发生竞争。 </font></p>
<p><font face="Adobe Caslon Pro">class-incremental 模型是对下面的式子进行优化：</font></p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><munder><mo><mi>max</mi><mo>⁡</mo></mo><mi>θ</mi></munder><mtext> </mtext><msub><mi mathvariant="double-struck">E</mi><mrow><mi>t</mi><mo>∼</mo><mi mathvariant="script">T</mi></mrow></msub><mo fence="false">[</mo><msub><mi mathvariant="double-struck">E</mi><mrow><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>∼</mo><msub><mi>T</mi><mi>t</mi></msub></mrow></msub><mo fence="false">[</mo><mi>log</mi><mo>⁡</mo><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>y</mi><mi mathvariant="normal">∣</mi><mi>x</mi><mo stretchy="false">)</mo><mo fence="false">]</mo><mo fence="false">]</mo><mspace width="2em"><mspace width="2em"><mo stretchy="false">(</mo><mn>2</mn><mo stretchy="false">)</mo></mspace></mspace></mrow><annotation encoding="application/x-tex">\max_\theta\ \mathbb{E}_{t\sim\mathcal{T}}\Big[
\mathbb{E}_{(x,y)\sim T_t}\big[
\log p_\theta(y|x)
\big]
\Big]
\qquad\qquad(2)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.902108em;vertical-align:-0.752108em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.43055999999999994em;"><span style="top:-2.047892em;margin-left:0em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span><span class="mop">max</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.752108em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace"> </span><span class="mord"><span class="mord"><span class="mord mathbb">E</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mrel mtight">∼</span><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right:0.25417em;">T</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="delimsizing size2">[</span></span><span class="mord"><span class="mord"><span class="mord mathbb">E</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">x</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span><span class="mclose mtight">)</span><span class="mrel mtight">∼</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.29634285714285713em;"><span style="top:-2.357em;margin-left:-0.13889em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class="mord"><span class="delimsizing size1">[</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord">∣</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mord"><span class="delimsizing size1">]</span></span><span class="mord"><span class="delimsizing size2">]</span></span><span class="mspace" style="margin-right:2em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mopen">(</span><span class="mord">2</span><span class="mclose">)</span></span></span></span></span></p>
<p><font face="Adobe Caslon Pro">缺少任务标签限制了模型中任何形式的已知任务类型情况下的推理。该 setting 需要将输出单元合并到单个分类器（<em>single-head</em>）中，来自不同任务的类在其中相互竞争，这通常会导致更严重的遗忘[35]。尽管模型在训练阶段可以基于任务信息进行学习，但是在推理过程中任务标签是不可知的。</font></p>
<p><font face="Adobe Caslon Pro">为了处理来自未知任务的样例，同时保留 multi-head settings 的优势，我们将联合优化类预测和任务预测，如下所示： </font></p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><munder><mo><mi>max</mi><mo>⁡</mo></mo><mi>θ</mi></munder><mtext> </mtext></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mi mathvariant="double-struck">E</mi><mrow><mi>t</mi><mo>∼</mo><mi mathvariant="script">T</mi></mrow></msub><mo fence="false">[</mo><msub><mi mathvariant="double-struck">E</mi><mrow><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>∼</mo><msub><mi>T</mi><mi>t</mi></msub></mrow></msub><mo fence="false">[</mo><mi>log</mi><mo>⁡</mo><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>y</mi><mo separator="true">,</mo><mi>t</mi><mi mathvariant="normal">∣</mi><mi>x</mi><mo stretchy="false">)</mo><mo fence="false">]</mo><mo fence="false">]</mo><mo>=</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><msub><mi mathvariant="double-struck">E</mi><mrow><mi>t</mi><mo>∼</mo><mi mathvariant="script">T</mi></mrow></msub><mo fence="false">[</mo><msub><mi mathvariant="double-struck">E</mi><mrow><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>∼</mo><msub><mi>T</mi><mi>t</mi></msub></mrow></msub><mo fence="false">[</mo><mi>log</mi><mo>⁡</mo><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>y</mi><mi mathvariant="normal">∣</mi><mi>x</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo><mo>+</mo><mi>log</mi><mo>⁡</mo><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>t</mi><mi mathvariant="normal">∣</mi><mi>x</mi><mo stretchy="false">)</mo><mo fence="false">]</mo><mo fence="false">]</mo><mspace width="2em"><mspace width="2em"><mo stretchy="false">(</mo><mn>3</mn><mo stretchy="false">)</mo></mspace></mspace></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}
\max_\theta\ &amp;\mathbb{E}_{t\sim\mathcal{T}}\Big[
\mathbb{E}_{(x,y)\sim T_t}\big[
\log p_\theta(y,t|x)
\big]
\Big]=\\
&amp;\mathbb{E}_{t\sim\mathcal{T}}\Big[
\mathbb{E}_{(x,y)\sim T_t}\big[
\log p_\theta(y|x,t) + \log p_\theta(t|x)
\big]
\Big]
\qquad\qquad(3)
\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.302128em;vertical-align:-1.9010639999999999em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.401064em;"><span style="top:-4.401064em;"><span class="pstrut" style="height:3.15em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.43055999999999994em;"><span style="top:-2.047892em;margin-left:0em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span><span style="top:-2.7em;"><span class="pstrut" style="height:2.7em;"></span><span><span class="mop">max</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.752108em;"><span></span></span></span></span></span><span class="mspace"> </span></span></span><span style="top:-2.198956em;"><span class="pstrut" style="height:3.15em;"></span><span class="mord"></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.9010639999999999em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.401064em;"><span style="top:-4.401064em;"><span class="pstrut" style="height:3.15em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord"><span class="mord mathbb">E</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mrel mtight">∼</span><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right:0.25417em;">T</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="delimsizing size2">[</span></span><span class="mord"><span class="mord"><span class="mord mathbb">E</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">x</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span><span class="mclose mtight">)</span><span class="mrel mtight">∼</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.29634285714285713em;"><span style="top:-2.357em;margin-left:-0.13889em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class="mord"><span class="delimsizing size1">[</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">t</span><span class="mord">∣</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mord"><span class="delimsizing size1">]</span></span><span class="mord"><span class="delimsizing size2">]</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span></span></span><span style="top:-2.198956em;"><span class="pstrut" style="height:3.15em;"></span><span class="mord"><span class="mord"></span><span class="mord"><span class="mord"><span class="mord mathbb">E</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.32833099999999993em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span><span class="mrel mtight">∼</span><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right:0.25417em;">T</span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="delimsizing size2">[</span></span><span class="mord"><span class="mord"><span class="mord mathbb">E</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">x</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span><span class="mclose mtight">)</span><span class="mrel mtight">∼</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.29634285714285713em;"><span style="top:-2.357em;margin-left:-0.13889em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class="mord"><span class="delimsizing size1">[</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord">∣</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">t</span><span class="mord">∣</span><span class="mord mathdefault">x</span><span class="mclose">)</span><span class="mord"><span class="delimsizing size1">]</span></span><span class="mord"><span class="delimsizing size2">]</span></span><span class="mspace" style="margin-right:2em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mopen">(</span><span class="mord">3</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.9010639999999999em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p><font face="Adobe Caslon Pro">Eq. 3 描述了两重目标。一方面，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>log</mi><mo>⁡</mo><mi>p</mi><mo stretchy="false">(</mo><mi>y</mi><mi mathvariant="normal">∣</mi><mi>x</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\log p(y|x,t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">p</span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord">∣</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">t</span><span class="mclose">)</span></span></span></span> 负责 class classification given the task，与 Eq. 1 中的 multi-head objective 相似。另一方面，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>log</mi><mo>⁡</mo><mi>p</mi><mo stretchy="false">(</mo><mi>t</mi><mi mathvariant="normal">∣</mi><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\log p(t|x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">p</span><span class="mopen">(</span><span class="mord mathdefault">t</span><span class="mord">∣</span><span class="mord mathdefault">x</span><span class="mclose">)</span></span></span></span> 旨在从所观察到的样例来 predicting the task。这种预测依赖于一个任务分类器，该任务分类器以 single-head 方式进行增量训练。值得注意的是，Eq. 3 中的目标将 single-head 复杂性从类预测转移到任务预测级别，具有以下好处：</font></p>
<ul>
<li>
<p><font face="Adobe Caslon Pro">给定任务标签，类预测准确性不会下降；</font></p>
</li>
<li>
<p><font face="Adobe Caslon Pro">来自不同任务的类在训练和测试期间都不会相互竞争；</font></p>
</li>
<li>
<p><font face="Adobe Caslon Pro">具有挑战性的 sing-head 预测步骤已从类级别转移到任务级别；由于任务和类形成两级层次结构，因此前者的预测可以说更容易（因为它在较粗略的语义级别上起作用）。 </font></p>
</li>
</ul>

        <h3 id="font-faceadobe-caslon-pro32-multihead-learning-of-class-labelsfont">
          <a href="#font-faceadobe-caslon-pro32-multihead-learning-of-class-labelsfont" class="heading-link"><i class="fas fa-link"></i></a>3.2 Multihead learning of class labels</h3>
      
<p><font face="Adobe Caslon Pro">在本节中，我们介绍了我们所使用的条件计算模型。 Fig. 1 说明了我们框架中使用的门控（gating）机制。我们对门控机制的讨论将仅限于卷积层的情况，但是它也适用于其他参数化映射，例如全连接层或残差块（residual blocks）。<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi mathvariant="bold-italic">h</mi><mi>l</mi></msup><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mrow><msubsup><mi>c</mi><mrow><mi>i</mi><mi>n</mi></mrow><mi>l</mi></msubsup><mo separator="true">,</mo><mi>h</mi><mo separator="true">,</mo><mi>w</mi></mrow></msup></mrow><annotation encoding="application/x-tex">\boldsymbol{h}^l\in\mathbb{R}^{c_{in}^l,h,w}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9725479999999999em;vertical-align:-0.0391em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">h</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9334479999999998em;"><span style="top:-3.1473400000000002em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.0119199999999997em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathbb">R</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.0119199999999997em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9270285714285713em;"><span style="top:-2.214em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">n</span></span></span></span><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286em;"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">h</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:0.02691em;">w</span></span></span></span></span></span></span></span></span></span></span></span> 表示 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span></span></span></span>-th 卷积层的输入 feature maps，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi mathvariant="bold-italic">h</mi><mrow><mi>l</mi><mo>+</mo><mn>1</mn></mrow></msup><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mrow><msubsup><mi>c</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow><mi>l</mi></msubsup><mo separator="true">,</mo><msup><mi>h</mi><mo mathvariant="normal">′</mo></msup><mo separator="true">,</mo><msup><mi>w</mi><mo mathvariant="normal">′</mo></msup></mrow></msup></mrow><annotation encoding="application/x-tex">\boldsymbol{h}^{l+1}\in\mathbb{R}^{c_{out}^l,h&#x27;,w&#x27;}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9725479999999999em;vertical-align:-0.0391em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">h</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9334479999999998em;"><span style="top:-3.14734em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.0119199999999997em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord mathbb">R</span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.0119199999999997em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9270285714285713em;"><span style="top:-2.214em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight">t</span></span></span></span><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286em;"><span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathdefault mtight">h</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278285714285715em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mpunct mtight">,</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278285714285715em;"><span style="top:-2.931em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span> 表示 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span></span></span></span>-th 卷积层的输出 feature maps。但是，我们不直接使用 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mi mathvariant="bold-italic">h</mi><mrow><mi>l</mi><mo>+</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\boldsymbol{h}^{l+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9334479999999998em;vertical-align:0em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">h</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9334479999999998em;"><span style="top:-3.14734em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span>，而是通过剪除掉没有什么信息量的 channels，前向传播一个稀疏的 feature map <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mover accent="true"><mi mathvariant="bold-italic">h</mi><mo>^</mo></mover><mrow><mi>l</mi><mo>+</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\hat{\boldsymbol{h}}^{l+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1968879999999997em;vertical-align:0em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9578799999999998em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">h</span></span></span></span></span><span style="top:-3.26344em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;">^</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.1968879999999997em;"><span style="top:-3.41078em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span> 。在训练任务 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathdefault">t</span></span></span></span> 的过程中，由gating module <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>G</mi><mi>t</mi><mi>l</mi></msubsup></mrow><annotation encoding="application/x-tex">G_t^l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.096108em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathdefault">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span> 决定激活哪些 channels：   </font></p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msup><mover accent="true"><mi mathvariant="bold-italic">h</mi><mo>^</mo></mover><mrow><mi>l</mi><mo>+</mo><mn>1</mn></mrow></msup><mo>=</mo><msubsup><mi>G</mi><mi>t</mi><mi>l</mi></msubsup><mo stretchy="false">(</mo><msup><mi mathvariant="bold-italic">h</mi><mi>l</mi></msup><mo stretchy="false">)</mo><mo>⊙</mo><msup><mi mathvariant="bold-italic">h</mi><mrow><mi>l</mi><mo>+</mo><mn>1</mn></mrow></msup><mspace width="2em"><mspace width="2em"><mo stretchy="false">(</mo><mn>4</mn><mo stretchy="false">)</mo></mspace></mspace></mrow><annotation encoding="application/x-tex">\hat{\boldsymbol{h}}^{l+1}=G_t^l(\boldsymbol{h}^{l})\odot\boldsymbol{h}^{l+1}\qquad\qquad(4)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1968879999999997em;vertical-align:0em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9578799999999998em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">h</span></span></span></span></span><span style="top:-3.26344em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;">^</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.1968879999999997em;"><span style="top:-3.41078em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1834479999999998em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999998em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">h</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9334479999999998em;"><span style="top:-3.1473400000000002em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⊙</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1.1834479999999998em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">h</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9334479999999998em;"><span style="top:-3.14734em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:2em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mopen">(</span><span class="mord">4</span><span class="mclose">)</span></span></span></span></span></p>
<p><font face="Adobe Caslon Pro">其中 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>G</mi><mi>t</mi><mi>l</mi></msubsup><mo stretchy="false">(</mo><msup><mi mathvariant="bold-italic">h</mi><mi>l</mi></msup><mo stretchy="false">)</mo><mo>=</mo><mo stretchy="false">[</mo><msubsup><mi>g</mi><mn>1</mn><mi>l</mi></msubsup><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msubsup><mi>g</mi><msubsup><mi>c</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow><mi>l</mi></msubsup><mi>l</mi></msubsup><mo stretchy="false">]</mo><mo separator="true">,</mo><msubsup><mi>g</mi><mi>i</mi><mi>l</mi></msubsup><mo>∈</mo><mo stretchy="false">{</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">G_t^l(\boldsymbol{h}^{l})=[g_1^l,...,g_{c_{out}^l}^l],g_i^l\in\{0,1\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1834479999999998em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">h</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9334479999999998em;"><span style="top:-3.1473400000000002em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.438068em;vertical-align:-0.58896em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-2.4518920000000004em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24810799999999997em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-2.31442em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathdefault mtight">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8408285714285715em;"><span style="top:-2.209457142857143em;margin-left:0em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight">t</span></span></span></span><span style="top:-2.8448em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29054285714285716em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.58896em;"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-2.441336em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.258664em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mclose">}</span></span></span></span>，其中 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>⊙</mo></mrow><annotation encoding="application/x-tex">\odot</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.66666em;vertical-align:-0.08333em;"></span><span class="mord">⊙</span></span></span></span> 表示 channel-wise 的乘法。为了符合增量设定，每次模型观察到来自新任务的样例时，我们都会实例化一个新的 gating module。每个 module 被设计为轻量级网络，其计算成本和参数数量可忽略不计。具体来说，每个 gating module 均包括一个多层感知器（MLP），其中包含一层具有16个单元的单层隐藏层，后面接着一个 batch normalization layer [12] 和ReLU激活函数。最终的线性映射为卷积的每个输出通道提供了对数概率。  </font></p>
<img src="/2021/01/11/Paper-Note-Conditional-Channel-Gated-Networks-for-Task-Aware-Continual-Learning/01.png" class>
<p><font face="Adobe Caslon Pro">伴有 gates 的反向传播梯度具有挑战性，因为要采用不可微分的阈值来进行二进制开/关决策。因此，我们依赖于Gumbel-Softmax采样[13, 19]，并使用 straight-through estimator[4]获得了梯度的有偏估计。具体来说，我们在前向传播过程中采用硬阈值（以零为中心），而在后向传播中采用 sigmoid 函数（温度参数 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>τ</mi><mo>=</mo><mn>2</mn><mi mathvariant="normal">/</mi><mn>3</mn></mrow><annotation encoding="application/x-tex">\tau=2/3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.1132em;">τ</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">2</span><span class="mord">/</span><span class="mord">3</span></span></span></span>）。</font></p>
<p><font face="Adobe Caslon Pro"> 此外，我们以稀疏化目标惩罚了活跃卷积核的数量： </font></p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="script">L</mi><mrow><mi>s</mi><mi>p</mi><mi>a</mi><mi>r</mi><mi>s</mi><mi>e</mi></mrow></msub><mo>=</mo><msub><mi mathvariant="double-struck">E</mi><mrow><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>∼</mo><msub><mi>T</mi><mi>t</mi></msub></mrow></msub><mo fence="false">[</mo><mfrac><msub><mi>λ</mi><mi>s</mi></msub><mi>L</mi></mfrac><munderover><mo>∑</mo><mrow><mi>l</mi><mo>=</mo><mn>1</mn></mrow><mi>L</mi></munderover><mfrac><mrow><mi mathvariant="normal">∥</mi><msubsup><mi>G</mi><mi>t</mi><mi>l</mi></msubsup><mo stretchy="false">(</mo><msup><mi mathvariant="bold-italic">h</mi><mi>l</mi></msup><mo stretchy="false">)</mo><msub><mi mathvariant="normal">∥</mi><mn>1</mn></msub></mrow><msubsup><mi>c</mi><mrow><mi>o</mi><mi>u</mi><mi>t</mi></mrow><mi>l</mi></msubsup></mfrac><mo fence="false">]</mo><mspace width="2em"><mspace width="2em"><mo stretchy="false">(</mo><mn>5</mn><mo stretchy="false">)</mo></mspace></mspace></mrow><annotation encoding="application/x-tex">\mathcal{L}_{sparse}=\mathbb{E}_{(x,y)\sim T_t}\Big[\cfrac{\lambda_s}{L}\sum_{l=1}^L\cfrac{\|G_t^l(\boldsymbol{h}^l)\|_1}{c_{out}^l}\Big]
\qquad\qquad(5)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">e</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.1304490000000005em;vertical-align:-1.302113em;"></span><span class="mord"><span class="mord"><span class="mord mathbb">E</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.34480000000000005em;"><span style="top:-2.5198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">x</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span><span class="mclose mtight">)</span><span class="mrel mtight">∼</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.29634285714285713em;"><span style="top:-2.357em;margin-left:-0.13889em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3551999999999999em;"><span></span></span></span></span></span></span><span class="mord"><span class="delimsizing size2">[</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.5899999999999999em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">L</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.74em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283360000000002em;"><span style="top:-1.8478869999999998em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.0500049999999996em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.300005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">L</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.302113em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.673448em;"><span style="top:-2.2790920000000003em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathdefault">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8309079999999999em;"><span style="top:-2.454244em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">o</span><span class="mord mathdefault mtight">u</span><span class="mord mathdefault mtight">t</span></span></span></span><span style="top:-3.0448em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24575599999999992em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.74em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">∥</span><span class="mord"><span class="mord mathdefault">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">h</span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9334479999999998em;"><span style="top:-3.1473400000000002em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord"><span class="mord">∥</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.9666639999999997em;"><span></span></span></span></span></span><span></span></span><span class="mord"><span class="delimsizing size2">]</span></span><span class="mspace" style="margin-right:2em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mopen">(</span><span class="mord">5</span><span class="mclose">)</span></span></span></span></span></p>
<p><font face="Adobe Caslon Pro">其中 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">L</span></span></span></span> 是 gated layers 的总数，而 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>λ</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">\lambda_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 是控制稀疏度的系数。稀疏化目标指示每个 gating module 选择最少的 kernels 集，从而使我们可以保留 filters 以优化将来的任务。此外，它使我们能够根据任务的难度和目前观察到的样例，有效地调整已经分配的网络的容量。这种数据驱动的模型选择与其它采用固定比率进行模型增长[30]或权重修剪[21]的持续学习策略形成对比。</font></p>
<p><font face="Adobe Caslon Pro">在对任务 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathdefault">t</span></span></span></span> 结束优化的时候，我们通过在一个验证集 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>T</mi><mi>t</mi><mrow><mi>v</mi><mi>a</mi><mi>l</mi></mrow></msubsup></mrow><annotation encoding="application/x-tex">T_t^{val}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.096108em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-2.4530000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">v</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span> 上估计 gates 打开状态的概率，对 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span></span></span></span>-th 层的每一个 unit 计算一个关联分数 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>r</mi><mi>k</mi><mi>l</mi></msubsup></mrow><annotation encoding="application/x-tex">r_k^l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.132216em;vertical-align:-0.2831079999999999em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-2.4168920000000003em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831079999999999em;"><span></span></span></span></span></span></span></span></span></span> ：</font></p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>r</mi><mi>k</mi><mrow><mi>l</mi><mo separator="true">,</mo><mi>t</mi></mrow></msubsup><mo>=</mo><msub><mi mathvariant="double-struck">E</mi><mrow><mo stretchy="false">(</mo><mi>x</mi><mo separator="true">,</mo><mi>y</mi><mo stretchy="false">)</mo><mo>∼</mo><msubsup><mi>T</mi><mi>t</mi><mrow><mi>v</mi><mi>a</mi><mi>l</mi></mrow></msubsup></mrow></msub><mo stretchy="false">[</mo><mi>p</mi><mo stretchy="false">(</mo><mi mathvariant="double-struck">I</mi><mo stretchy="false">[</mo><msubsup><mi>g</mi><mi>k</mi><mi>l</mi></msubsup><mo>=</mo><mn>1</mn><mo stretchy="false">]</mo><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mspace width="2em"><mspace width="2em"><mo stretchy="false">(</mo><mn>6</mn><mo stretchy="false">)</mo></mspace></mspace></mrow><annotation encoding="application/x-tex">r_k^{l,t}=\mathbb{E}_{(x,y)\sim T_t^{val}}[p(\mathbb{I}[g_k^l=1])]\qquad\qquad(6)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2683239999999998em;vertical-align:-0.3013079999999999em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9670159999999998em;"><span style="top:-2.3986920000000005em;margin-left:-0.02778em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.180908em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3013079999999999em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.3462679999999998em;vertical-align:-0.44716em;"></span><span class="mord"><span class="mord"><span class="mord mathbb">E</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3448em;"><span style="top:-2.45622em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathdefault mtight">x</span><span class="mpunct mtight">,</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">y</span><span class="mclose mtight">)</span><span class="mrel mtight">∼</span><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8408285714285715em;"><span style="top:-2.209457142857143em;margin-left:-0.13889em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-2.8448em;margin-right:0.07142857142857144em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">v</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.29054285714285716em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.44716em;"><span></span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathdefault">p</span><span class="mopen">(</span><span class="mord"><span class="mord mathbb">I</span></span><span class="mopen">[</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999998em;"><span style="top:-2.4530000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.03148em;">k</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1</span><span class="mclose">]</span><span class="mclose">)</span><span class="mclose">]</span><span class="mspace" style="margin-right:2em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mopen">(</span><span class="mord">6</span><span class="mclose">)</span></span></span></span></span></p>
<p><font face="Adobe Caslon Pro">其中 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="double-struck">I</mi><mo stretchy="false">[</mo><mo>⋅</mo><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\mathbb{I}[\cdot]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathbb">I</span></span><span class="mopen">[</span><span class="mord">⋅</span><span class="mclose">]</span></span></span></span> 为指示函数，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>p</mi><mo stretchy="false">(</mo><mo>⋅</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p(\cdot)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault">p</span><span class="mopen">(</span><span class="mord">⋅</span><span class="mclose">)</span></span></span></span> 为概率分布。通过对这些分数进行阈值处理（thresholding），我们获得了两组 kernels。一方面，我们冻结了任务 t 的相关 kernels，以便它们在将来的任务中可用，但不可更新。另一方面，我们重新初始化不相关的 kernels，使它们在后续任务中是可学习的。在我们所有的实验中，我们都使用0作为阈值，这可以防止遗忘，但代价是减少了留给未来任务的模型容量。</font></p>
<p><font face="Adobe Caslon Pro">请注意，在此框架内，观察每层中剩余的可学习 units 的数量是很简单的。这样，如果 backbone 模型的容量达到饱和，我们可以快速扩展网络以消化新任务。但是，由于新任务的 gating modules 可以动态选择使用之前习得的 filters（如果与它们的输入相关），因此学习新任务通常需要较少的可学习的 units。在实践中，我们从未经历过学习新任务的 backbone 模型的饱和。除此之外，由于我们的 conditional channel-gated 网络设计，为未来任务增加模型容量将对推理时的计算成本影响很小，将在 Sec 4.5 部分对此进行分析。</font></p>

        <h3 id="font-faceadobe-caslon-pro33-single-head-learning-of-task-labelsfont">
          <a href="#font-faceadobe-caslon-pro33-single-head-learning-of-task-labelsfont" class="heading-link"><i class="fas fa-link"></i></a>3.3. Single-head learning of task labels</h3>
      
<p><font face="Adobe Caslon Pro">在 Sec. 3.2 中介绍的选通方案（gating scheme）能够立即识别过去的每个任务的重要 kernels。但是，它不能应用于任务不可知的setting，因为它需要知道对于第 l 层须要应用哪个选通模块 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msubsup><mi>G</mi><mi>x</mi><mi>l</mi></msubsup></mrow><annotation encoding="application/x-tex">G_x^l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.096108em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathdefault">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">x</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span>，其中 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>x</mi><mo>∈</mo><mo stretchy="false">{</mo><mn>1</mn><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">x\in\{1,...,t\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathdefault">x</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">{</span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">t</span><span class="mclose">}</span></span></span></span> 表示未知任务。 我们的解决方案是采用所有选通模块 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">[</mo><msubsup><mi>G</mi><mn>1</mn><mi>l</mi></msubsup><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msubsup><mi>G</mi><mi>t</mi><mi>l</mi></msubsup><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[G_1^l,...,G_t^l]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.099108em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathdefault">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-2.4518920000000004em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24810799999999997em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.849108em;"><span style="top:-2.4530000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span>，并将所有选通层（gated layer）的输出 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">[</mo><msubsup><mover accent="true"><mi mathvariant="bold-italic">h</mi><mo>^</mo></mover><mn>1</mn><mrow><mi>l</mi><mo>+</mo><mn>1</mn></mrow></msubsup><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msubsup><mover accent="true"><mi mathvariant="bold-italic">h</mi><mo>^</mo></mover><mi>t</mi><mrow><mi>l</mi><mo>+</mo><mn>1</mn></mrow></msubsup><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[\hat{\boldsymbol{h}}_1^{l+1},...,\hat{\boldsymbol{h}}_t^{l+1}]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4468879999999997em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9578799999999998em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">h</span></span></span></span></span><span style="top:-3.26344em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;">^</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1968879999999997em;"><span style="top:-2.4530000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.41078em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9578799999999998em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">h</span></span></span></span></span><span style="top:-3.26344em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;">^</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1968879999999997em;"><span style="top:-2.4530000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.41078em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span> 前向传播。 依次地，下一层 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">l+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.77777em;vertical-align:-0.08333em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> 从第 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.01968em;">l</span></span></span></span> 层接收 gated outputs 列表，应用其选通模块 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">[</mo><msubsup><mi>G</mi><mn>1</mn><mrow><mi>l</mi><mo>+</mo><mn>1</mn></mrow></msubsup><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msubsup><mi>G</mi><mi>t</mi><mrow><mi>l</mi><mo>+</mo><mn>1</mn></mrow></msubsup><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[G_1^{l+1},...,G_t^{l+1}]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1555469999999999em;vertical-align:-0.266308em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathdefault">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8892389999999999em;"><span style="top:-2.433692em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.1031310000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.266308em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">G</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8892389999999999em;"><span style="top:-2.454244em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.1031310000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.24575599999999997em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span> 并产生输出列表 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo stretchy="false">[</mo><msubsup><mover accent="true"><mi mathvariant="bold-italic">h</mi><mo>^</mo></mover><mn>1</mn><mrow><mi>l</mi><mo>+</mo><mn>2</mn></mrow></msubsup><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><msubsup><mover accent="true"><mi mathvariant="bold-italic">h</mi><mo>^</mo></mover><mi>t</mi><mrow><mi>l</mi><mo>+</mo><mn>2</mn></mrow></msubsup><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[\hat{\boldsymbol{h}}_1^{l+2},...,\hat{\boldsymbol{h}}_t^{l+2}]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4468879999999997em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9578799999999998em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">h</span></span></span></span></span><span style="top:-3.26344em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;">^</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1968879999999997em;"><span style="top:-2.4530000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span><span style="top:-3.41078em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mbin mtight">+</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9578799999999998em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">h</span></span></span></span></span><span style="top:-3.26344em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;">^</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1968879999999997em;"><span style="top:-2.4530000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span><span style="top:-3.41078em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.01968em;">l</span><span class="mbin mtight">+</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span>。这种机制在网络中生成并行的计算流，共享相同的层，但为每个层选择不同的 sets of units 进行激活（Fig. 2）。尽管并行流的数量随任务的数量而增长，但我们发现我们的解决方案在计算上比 backbone 网络开销更小（见 Sec. 4.5）。这是由于选通模块在每个流中选择了数量有限的卷积 filters。 </font></p>
<img src="/2021/01/11/Paper-Note-Conditional-Channel-Gated-Networks-for-Task-Aware-Continual-Learning/02.png" class>
<p><font face="Adobe Caslon Pro">在最后一个卷积层（即第 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord mathdefault">L</span></span></span></span> 层）之后，我们得到了 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathdefault">t</span></span></span></span> 个候选 feature maps 构成的列表和同样多的分类头。所有 feature maps 连接之后输入到任务分类器：</font></p>
<p class="katex-block"><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>h</mi><mo>=</mo><munderover><mo>⨁</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>t</mi></munderover><mo stretchy="false">[</mo><mi>μ</mi><mo stretchy="false">(</mo><msubsup><mover accent="true"><mi mathvariant="bold-italic">h</mi><mo>^</mo></mover><mi>i</mi><mrow><mi>L</mi><mo>+</mo><mn>1</mn></mrow></msubsup><mo stretchy="false">)</mo><mo stretchy="false">]</mo><mo separator="true">,</mo><mspace width="2em"><mspace width="2em"><mo stretchy="false">(</mo><mn>7</mn><mo stretchy="false">)</mo></mspace></mspace></mrow><annotation encoding="application/x-tex">h=\bigoplus_{i=1}^t[\mu(\hat{\boldsymbol{h}}_i^{L+1})],\qquad\qquad(7)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault">h</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.05823em;vertical-align:-1.277669em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.7805610000000003em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">⨁</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mopen">[</span><span class="mord mathdefault">μ</span><span class="mopen">(</span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9578799999999998em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord"><span class="mord boldsymbol">h</span></span></span></span></span><span style="top:-3.26344em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.25em;">^</span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.1891109999999998em;"><span style="top:-2.4530000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight">i</span></span></span><span style="top:-3.41078em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">L</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mspace" style="margin-right:2em;"></span><span class="mopen">(</span><span class="mord">7</span><span class="mclose">)</span></span></span></span></span></p>
<p><font face="Adobe Caslon Pro">其中，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>μ</mi></mrow><annotation encoding="application/x-tex">\mu</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathdefault">μ</span></span></span></span> 表示空间维度上的全局平均池化（global average pooling）算子，<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mo>⨁</mo></mrow><annotation encoding="application/x-tex">\bigoplus</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.00001em;vertical-align:-0.25001em;"></span><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">⨁</span></span></span></span> 表示对特征的连接。任务分类器的结构基于浅层MLP，包含一个具有 64 个ReLU units 的隐藏层，后面接着一个预测任务标签的softmax层。我们使用标准的交叉熵目标函数来训练任务分类器。对任务分类器的优化与对任务 t 的类标签的学习一起进行。因此，网络不仅学习区分任务t中的类的特征，而且还学习去区分任务t和所有先前任务的输入数据的区别。</font></p>
<p><font face="Adobe Caslon Pro">single-head 任务分类器容易遭受灾难性遗忘。最近的论文表明，基于重放的策略是 single-head settings 中最有效的持续学习策略[35]。因此，我们选择通过 rehearsal 来改善问题。 特别是，我们考虑以下方法。</font></p>
<p><font face="Adobe Caslon Pro"><strong>Episodic memory.</strong> 先前任务的一小部分样例用于 rehearse 任务分类器。在训练任务 t 的过程中，buffer 保留了来自过去任务 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mn>1</mn><mo separator="true">,</mo><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mi mathvariant="normal">.</mi><mo separator="true">,</mo><mi>t</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">1,...,t-1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">.</span><span class="mord">.</span><span class="mord">.</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">t</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span></span></span></span> 的C个随机样例（其中C表示固定容量）。对 buffer 和当前 batch（来自任务 t ）中的样例进行重新采样，以使任务标签在 rehearsal batch 中的分布均匀。在任务 t 的末尾，对 buffer 中的数据进行二次采样，以使每个过去的任务都包含 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>m</mi><mo>=</mo><mi>C</mi><mi mathvariant="normal">/</mi><mi>t</mi></mrow><annotation encoding="application/x-tex">m = C / t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathdefault">m</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.07153em;">C</span><span class="mord">/</span><span class="mord mathdefault">t</span></span></span></span> 个样例。 最后，从任务 t 中选择 m 个随机样例进行存储。</font></p>
<p><font face="Adobe Caslon Pro"><strong>Generative memory.</strong> 生成模型用于从先前任务中采样伪造的数据。具体来说，我们利用Wasserstein GANs with Gradient Penalty（WGAN-GP [10]）。为了克服采样过程中的遗忘，我们使用了多个生成器，每个生成器都对特定任务的样例分布进行建模。</font></p>
<p><font face="Adobe Caslon Pro">在这两种情况下，replay 仅用于 rehearse 任务分类器，而不用于分类头。概括而言，我们的模型的完整目标为：class level 的交叉熵（Eq. 3 中的<span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>y</mi><mi mathvariant="normal">∣</mi><mi>x</mi><mo separator="true">,</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p_\theta(y|x,t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault" style="margin-right:0.03588em;">y</span><span class="mord">∣</span><span class="mord mathdefault">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault">t</span><span class="mclose">)</span></span></span></span>），task level 的交叉熵（Eq. 3 中的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>p</mi><mi>θ</mi></msub><mo stretchy="false">(</mo><mi>t</mi><mi mathvariant="normal">∣</mi><mi>x</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p_\theta(t|x)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathdefault">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">θ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathdefault">t</span><span class="mord">∣</span><span class="mord mathdefault">x</span><span class="mclose">)</span></span></span></span>）以及稀疏项（Eq.5 中的 <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi mathvariant="script">L</mi><mrow><mi>s</mi><mi>p</mi><mi>a</mi><mi>r</mi><mi>s</mi><mi>e</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{sparse}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">p</span><span class="mord mathdefault mtight">a</span><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span><span class="mord mathdefault mtight">s</span><span class="mord mathdefault mtight">e</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>）。</font></p>

        <h2 id="font-faceadobe-caslon-pro4-experimentsfont">
          <a href="#font-faceadobe-caslon-pro4-experimentsfont" class="heading-link"><i class="fas fa-link"></i></a>4. Experiments</h2>
      

        <h3 id="font-faceadobe-caslon-pro41-datasets-and-backbone-architecturesfont">
          <a href="#font-faceadobe-caslon-pro41-datasets-and-backbone-architecturesfont" class="heading-link"><i class="fas fa-link"></i></a>4.1. Datasets and backbone architectures</h3>
      
<p><font face="Adobe Caslon Pro">我们使用以下数据集进行了实验：</font></p>
<ul>
<li>
<p><font face="Adobe Caslon Pro">Split MNIST：将MNIST手写分类基准[16]分为5个连续类的子集，从而有了5个二分类任务被顺序训练。</font></p>
</li>
<li>
<p><font face="Adobe Caslon Pro">Split SVHN：与 Split MNIST 采用的分割方法相同，但采用了SVHN数据集[24]。</font></p>
</li>
<li>
<p><font face="Adobe Caslon Pro">Split CIFAR-10：与 Split MNIST 采用的分割方法相同，但采用的是CIFAR-10数据集[15]。</font></p>
</li>
<li>
<p><font face="Adobe Caslon Pro">Imagenet-50 [26]：iILSVRC-2012数据集[8]的子集，包含50个随机采样的类，每个类别1300张图像，分为5个连续的十分类问题。图像大小调整为32x32像素。</font></p>
</li>
</ul>
<p><font face="Adobe Caslon Pro">就 backbone 模型而言，对于MNIST和SVHN基准，我们采用了三层CNN，每层有100个filters 以及 ReLU 激活函数（下文中为 <em>SimpleCNN</em>）。除最后一层外的其它所有卷积后面都有一个 2x2 的 max-pooling layer。在池化层（pooling layer）之后应用门控。最后是全局平均池化（global average pooling），后面接着线性分类器，可得出分类预测。对于CIFAR-10 和 Imagenet-50 基准，我们采用 ResNet-18 [11] 模型作为 backbone。ResNet basic block 的门控版本如 Fig. 3 所示。如图所示，在第一次卷积之后和在残留连接（residual connection）之后分别应用了两组独立的 gates。</font></p>
<img src="/2021/01/11/Paper-Note-Conditional-Channel-Gated-Networks-for-Task-Aware-Continual-Learning/03.png" class>
<p><font face="Adobe Caslon Pro">所有模型都使用 SGD with momentum 进行训练，直到收敛为止。在完成每次任务后，通过在当前任务的样例构成的 held-out set 上对模型优化相应的目标函数，来对所有模型进行模型选择（即，我们不依赖于过去任务的样例来进行验证）。我们仅在预定数量的 epochs 之后才应用 Sec. 3.2 中介绍的稀疏化目标函数，使模型能够在开始修剪无信息量的 kernel 之前学习meaningful kernels。</font></p>

        <h3 id="font-faceadobe-caslon-pro42-task-incremental-settingfont">
          <a href="#font-faceadobe-caslon-pro42-task-incremental-settingfont" class="heading-link"><i class="fas fa-link"></i></a>4.2 Task-incremental setting</h3>
      
<p><font face="Adobe Caslon Pro">在 task-incremental setting 中，在测试期间任务标签是已知的。因此，我们不依赖于任务分类器，而是利用真实的任务标签来选择应启用的选通模块和分类头。本节验证了所提出的基于数据的门控方案（data-dependent gating scheme）对于持续学习的适用性。我们将模型与几种 competing methods 进行比较：</font></p>
<ul>
<li>
<p><font face="Adobe Caslon Pro"><em>Joint</em>：使用所有任务的所有数据集对 backbone 模型进行联合训练。我们将其性能视为上限。</font></p>
</li>
<li>
<p><font face="Adobe Caslon Pro"><em>Ewc-On</em> [31]：Elastic Weight Consolidation的在线版本，它依赖于参数的最新MAP估计以及Fisher矩阵的总和。 </font></p>
</li>
<li>
<p><font face="Adobe Caslon Pro"><em>LwF</em> [17]：该方法的任务损失函数由 distillation objective 正则，采用模型在处理当前任务之前的初始状态作为 teacher。</font></p>
</li>
<li>
<p><font face="Adobe Caslon Pro"><em>HAT</em> [32]：mask-based 的模型，使用任务标签对网络中的 active units 进行限制。尽管与我们的方法最相似，但它只能应用于 task-incremental setting。 </font></p>
</li>
</ul>
<p><font face="Adobe Caslon Pro">Tab. 1 展示了对不同方法在整个训练过程后所有任务的准确性方面的比较。尽管在MNIST上的表现非常相似，但是随着数据集变得越来越具有挑战性，不同模型的 consolidation capability 之间的差距逐渐显现。值得一提的是几种 recurring patterns。首先，当任务数量增加到两个以上时，LwF会遇到困难。尽管它的蒸馏目标函数是防止遗忘的极好的正则项，但它使得模型不具有足够的灵活性来获取新知识。因此，在顺序学习期间，它对最近任务的准确性逐渐降低，而对第一个任务的性能保持很高。此外，Tab. 1 强调了基于门控的方案（HAT和我们的方案）相对于其他 consolidation strategies（如EWC Online）的适用性。前者阻止相关参数的任何更新，而后一种方法仅惩罚对它们的更新，最终导致相当程度的遗忘。最后，Tab. 1 表明，我们的模型在所有数据集上的表现均与HAT相似甚至更好，这表明我们基于数据的选通方案和稀疏化目标函数有着出色的效果。 </font></p>
<img src="/2021/01/11/Paper-Note-Conditional-Channel-Gated-Networks-for-Task-Aware-Continual-Learning/05.png" class>

        <h3 id="font-faceadobe-caslon-pro43-classincremental-with-episodic-memoryfont">
          <a href="#font-faceadobe-caslon-pro43-classincremental-with-episodic-memoryfont" class="heading-link"><i class="fas fa-link"></i></a>4.3. Classincremental with episodic memory</h3>
      
<p><font face="Adobe Caslon Pro">接下来，我们讨论 class-incremental setting，在该 setting 下，在测试时不知道任务标签，这大大增加了持续学习问题的难度。在本节中，我们所进行的实验允许存储有限数量的样例（buffer）。 我们与以下方法进行比较： </font></p>
<ul>
<li>
<p><font face="Adobe Caslon Pro">Full replay：可以给网络重放之前任务所有的训练数据，即理论上的性能上界。</font></p>
</li>
<li>
<p><font face="Adobe Caslon Pro">iCaRL [27] 是一种基于最近邻分类器的方法，利用了 buffer 中的样例。我们给出了原始的buffer-filling strategy (<em>iCaRL-mean</em>) 和用于我们模型的随机算法（<em>iCaRL-rand</em>）。 </font></p>
</li>
<li>
<p><font face="Adobe Caslon Pro">A-GEM [5]：一种 buffer-based 的方法，可对当前任务的参数更新进行修正，以使其与在存储的样例中计算出的梯度不矛盾。 </font></p>
</li>
</ul>
<p><font face="Adobe Caslon Pro">结果汇总在 Fig. 4 中，说明了对于 class-incremental Split-MNIST 和 Split-SVHN 基准，在不同 buffer 大小下所有任务的最终平均准确度。该图突出了几个发现。出人意料的是，A-GEM在MNIST上的性能非常低，而在SVHN上却有更好的表现。对前一个数据集的进一步探究表明，它在最新任务上始终达到 competitive accuracy，而却忘记了先前的大多数任务。另一方面，iCaRL的性能似乎不会因更改其 buffer filling strategy 而受到显著影响。而且，其准确性似乎与所存储样例的数量不成比例。与这些方法相比，我们的模型主要利用一些存储的样例来进行粗粒度任务预测的 rehearsal，同时保留细粒度类预测的准确性。如 Fig. 4所示，在 class-incremental setting with episodic memory，我们的方法始终优于所比较的方法。 </font></p>
<img src="/2021/01/11/Paper-Note-Conditional-Channel-Gated-Networks-for-Task-Aware-Continual-Learning/04.png" class>

        <h3 id="font-faceadobe-caslon-pro44-classincremental-with-generative-memoryfont">
          <a href="#font-faceadobe-caslon-pro44-classincremental-with-generative-memoryfont" class="heading-link"><i class="fas fa-link"></i></a>4.4. Classincremental with generative memory</h3>
      
<p><font face="Adobe Caslon Pro">接下来，我们继续对 class-incremental setting 进行实验，但是这次不允许任何样例被存储。在此框架中，一种流行的策略是采用生成模型来近似先前任务的分布，并通过采用伪造的训练样本来 rehearse the backbone network。其中，DGM [26]是最先进的方法，它提出了一种 class-conditional GAN 结构，配之以与HAT [32]相似的硬注意力机制。GAN生成器（generator）所伪造的样例将重放到鉴别器（discriminator），该鉴别器包含了提供类预测的辅助分类器。至于我们的模型，如 Sec. 3.3 所述，我们依赖于多个特定于任务的生成器。Tab. 2 比较了DGM和我们的带有 generative memory 的 class-incremental setting的模型的结果。再次证明，我们仅针对任务分类器进行 rehearsal 的方法被证明是有益的。DGM在Split MNIST上的表现特别出色，其中的伪造样例与真实样例几乎没有区别。相反，结果表明，随着模型分布的复杂性增加，class-conditional rehearsal 可能变得毫无用处，并且生成的样本的视觉质量下降。 </font></p>
<img src="/2021/01/11/Paper-Note-Conditional-Channel-Gated-Networks-for-Task-Aware-Continual-Learning/tab2.png" class>

        <h3 id="font-faceadobe-caslon-pro45-model-analysisfont">
          <a href="#font-faceadobe-caslon-pro45-model-analysisfont" class="heading-link"><i class="fas fa-link"></i></a>4.5. Model analysis</h3>
      
<p><font face="Adobe Caslon Pro"><strong>Episodic vs. generative memory.</strong> 为了理解在处理 class-incremental learning 问题时必须采用哪种 rehearsal strategy，我们提出了以下问题：在有限数量的真实样例与（可能）无限数量的生成样例之间哪个好处更大一些？为了阐明这一点，我们报告了模型在Split SVHN和Split CIFAR-10上的性能与内存预算的关系。具体来说，我们将 episodic memories 的内存消耗计算为所存储样例的累积数量。对于 generative memories，我们考虑了存储其参数（以单精度浮点数格式存储）所需的字节数，丢弃了相应的鉴别器以及采样过程中生成的 inner activations。Fig. 5 给出了分析结果。可以看出，我们的依赖于 memory buffers 的模型变体始终优于依赖于 generative modeling 的模型。在CIFAR-10数据集上，generative replay 的准确性可与≈1.5 MB的 episodic memory 相媲美，后者比前者的生成器小20倍以上。两种策略之间的差距在SVHN上有所缩小，这是因为图像内容更简单，可以从生成器中获得更好的样本。最终，我们的方法基于memory buffers时，不仅需要的内存减少了3.6倍，而且其性能优于Split-SVHN上的DGMw模型[26]。</font></p>
<img src="/2021/01/11/Paper-Note-Conditional-Channel-Gated-Networks-for-Task-Aware-Continual-Learning/fig5.png" class>
<p><font face="Adobe Caslon Pro"><strong>Gate analysis.</strong> 我们对 Fig. 6 中不同任务之间的 the activation of gates 进行了定性分析。具体地说，我们使用 Split MNIST 和 Imagenet-50 的验证集来计算每个门被来自不同任务的图像触发的概率。对 Fig. 6 的分析提供了两个证据：首先，随着观察到更多的任务，先前习得的 features 被重新使用。这种特征表明该模型不会落入退化的解决方案中（例如，将任务完全隔离到不同的子网中）。相反，我们的模型从以前的任务中获取的知识可以用于未来的任务优化。此外，大量的门从未触发过，这表明 backbone 网络容量的相当一部分可用于学习更多任务。此外，我们展示了来自不同任务的能够激活相同filters的图像在 low-level 或语义特征上显示出某种相似之处。 </font></p>
<img src="/2021/01/11/Paper-Note-Conditional-Channel-Gated-Networks-for-Task-Aware-Continual-Learning/fig6.png" class>
<p><font face="Adobe Caslon Pro"><strong>On the cost of inference.</strong> 接下来，我们测量模型在任务数量增加时的推理成本。Tab. 3展示了学习完每个任务后在 Split MNIST 和 Split CIFAR-10的测试集上我们模型的multiply-add operations的平均数量（MAC count）。此外，我们展示了 HAT [32] 的 MACs 以及 backbone 网络前向传播的成本。在 task-incremental setting 中，由于基于数据的门控模块仅选择一小部分 filters 来使用，因此我们的模型可节省大量的 operations。相反，在class-incremental setting 中的前向传播需要与到目前为止观察到的任务数量一样多的计算流。但是，由于active的 convolutional units 很少，因此它们每个的开销都很小。如表中所示，在 class-incremental setting 中，operations 的数量永远不会超过 backbone 模型中前向传播的成本。对于 ResNet-18 backbone  在 Split CIFAR-10 上的表现，推断成本的降低尤为显著。 </font></p>
<img src="/2021/01/11/Paper-Note-Conditional-Channel-Gated-Networks-for-Task-Aware-Continual-Learning/tab3.png" class>
<p><font face="Adobe Caslon Pro"><strong>Limitations and future works.</strong> 训练我们的模型可能需要大量GPU内存才能容纳更大的 backbones。但是，通过利用 activation maps 的固有稀疏性，可以进行多种优化。 其次，任务分类器容易受到任务之间语义分离程度的影响。例如，在任务语义明确定义的 setting 中，比如 T1 = {cat，dog}，T2 = {car，truck}（动物/车辆）更适合于任务分类器，而反之，T1 = {cat，car}，T2 = {dog，truck} 则不然。但是，我们的实验中，将类到任务的分配始终是随机的。因此，在任务分野明显的情况下，我们的模型甚至可以表现更好。 </font></p>

        <h2 id="font-faceadobe-caslon-pro5-conclusionsfont">
          <a href="#font-faceadobe-caslon-pro5-conclusionsfont" class="heading-link"><i class="fas fa-link"></i></a>5. Conclusions</h2>
      
<p><font face="Adobe Caslon Pro">我们提出了一个基于条件计算的新颖框架，以解决卷积神经网络中的灾难性遗忘。拥有特定于任务的轻型门控模块，使我们能够防止灾难性地忘记先前学到的知识。除了为新任务学习新 features 外，这些门还允许动态使用以前学到的知识来提高性能。在测试过程中，无论有无任务标签，我们的方法都可以使用。在后一种情况下，训练任务分类器来代替任务标签。 通过广泛的实验，我们在 task-incremental 和class-incremental settings 中验证了模型相比于现有方法的性能表现，并在四个连续学习数据集中展示了state-of-the-art results。 </font></p>

        <h2 id="font-faceadobe-caslon-pro优点font">
          <a href="#font-faceadobe-caslon-pro优点font" class="heading-link"><i class="fas fa-link"></i></a>优点</h2>
      
<p><font face="Adobe Caslon Pro">本文最大的创新点是将条件计算引入到持续学习问题当中。之前的一些工作解决持续学习问题的思路也是基于 binary mask，但是这些 mask 更倾向于是 pre-defined，而不能在学习过程中去自动地学习。通过引入条件计算，具体而言是 gumbel-softmax，解决了后向传播时离散值的微分问题，使得网络也可以去学习适应于任务的 binary mask。</font></p>
<p><font face="Adobe Caslon Pro">其次，文章为了避免单个任务使用过多的 filters，在损失函数中增加了稀疏化的正则项，使得单个任务尽可能少地使用 filters，节约了网络容量，使得尽可能多地学习更多的任务。</font></p>

        <h2 id="font-faceadobe-caslon-pro缺点font">
          <a href="#font-faceadobe-caslon-pro缺点font" class="heading-link"><i class="fas fa-link"></i></a>缺点</h2>
      
<p><font face="Adobe Caslon Pro">本文提出的方法最大的问题是训练阶段的计算开销较大，即便是 task-incremental setting，由于要训练 gates，其成本会相应增加。对于 class-incremental 而言，虽说引入了任务分类器，但就其实质而言，还是用 rehearsal 来做，之前关于 rehearsal 的工作存在的问题，这里依旧，比如：存储开销、生成模型的计算开销、生成模型对于持续学习场景的适用性、数据隐私安全等问题。 </font></p>

        <h2 id="font-faceadobe-caslon-pro启发font">
          <a href="#font-faceadobe-caslon-pro启发font" class="heading-link"><i class="fas fa-link"></i></a>启发</h2>
      
<p><font face="Adobe Caslon Pro">本文所承接的研究路线是顺着 PackNet、HAT 等工作的思路来做的，也就是基于 binary mask 的想法。相比于之前的工作，将条件计算引入进来，是本文对这一研究路线的最大贡献。本文着重分析了在卷积层增加 gates 的效果，如何在其它领域应用这一技术也是值得探索的，比如NLP等。</font></p>
<p><font face="Adobe Caslon Pro">这一类工作的假设是网络大小不变，即如何在固定网络容量的条件下，尽可能持续学习各种任务。我认为，这一研究路线的发展路径是，在网络容量允许的情况下，继续去以 binary mask 分割相应于各任务的参数，而在必要的时候——即网络参数的使用情况已经近乎饱和，应该能够自动地去扩展网络。这一思路的研究已经出现，但是还并不多，也并不成熟。</font></p>
<p><font face="Adobe Caslon Pro"></font></p>
<p><font face="Adobe Caslon Pro"></font></p>
<p><font face="Adobe Caslon Pro"></font></p>
<center><font face="楷体" color="grey"> 至近至远东西，至深至浅清溪。至高至明日月，至亲至疏夫妻。</font></center>
</div><footer class="post-footer"><div class="post-ending ending"><div class="ending__text">------ END ------</div></div><div class="post-copyright copyright"><div class="copyright-author"><span class="copyright-author__name">Author: </span><span class="copyright-author__value"><a href="https://hello-liuyang.com">liuyang-70d12d</a></span></div><div class="copyright-link"><span class="copyright-link__name">Link: </span><span class="copyright-link__value"><a href="https://hello-liuyang.com/2021/01/11/Paper-Note-Conditional-Channel-Gated-Networks-for-Task-Aware-Continual-Learning/">https://hello-liuyang.com/2021/01/11/Paper-Note-Conditional-Channel-Gated-Networks-for-Task-Aware-Continual-Learning/</a></span></div><div class="copyright-notice"><span class="copyright-notice__name">Copyright: </span><span class="copyright-notice__value">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" rel="external nofollow" target="_blank">BY-NC-SA</a> unless stating additionally</span></div></div><div class="post-tags"><span class="post-tags-item"><span class="post-tags-item__icon"><i class="fas fa-tag"></i></span><a class="post-tags-item__link" href="https://hello-liuyang.com/tags/Continual-Learning/">Continual Learning</a></span></div><nav class="post-paginator paginator"><div class="paginator-next"><a class="paginator-next__link" href="/2021/01/07/Fabric-%E9%83%A8%E7%BD%B2%E7%B3%BB%E5%88%97%E5%AE%9E%E9%AA%8C/"><span class="paginator-prev__text">Fabric 部署系列实验</span><span class="paginator-next__icon"><i class="fas fa-angle-right"></i></span></a></div></nav></footer></div></div></div><div class="sidebar-wrap" id="sidebar-wrap"><aside class="sidebar" id="sidebar"><div class="sidebar-nav"><span class="sidebar-nav-toc current">Catalog</span><span class="sidebar-nav-ov">Overview</span></div><section class="sidebar-toc"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#font-faceadobe-caslon-proabstractfont"><span class="toc-number">1.</span> <span class="toc-text">
          Abstract</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#font-faceadobe-caslon-pro1-introductionfont"><span class="toc-number">2.</span> <span class="toc-text">
          1. Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#font-faceadobe-caslon-pro2-related-workfont"><span class="toc-number">3.</span> <span class="toc-text">
          2. Related work</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#font-faceadobe-caslon-pro3-modelfont"><span class="toc-number">4.</span> <span class="toc-text">
          3. Model</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#font-faceadobe-caslon-pro31-problem-setting-and-objectivefont"><span class="toc-number">4.1.</span> <span class="toc-text">
          3.1 Problem setting and objective</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#font-faceadobe-caslon-pro32-multihead-learning-of-class-labelsfont"><span class="toc-number">4.2.</span> <span class="toc-text">
          3.2 Multihead learning of class labels</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#font-faceadobe-caslon-pro33-single-head-learning-of-task-labelsfont"><span class="toc-number">4.3.</span> <span class="toc-text">
          3.3. Single-head learning of task labels</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#font-faceadobe-caslon-pro4-experimentsfont"><span class="toc-number">5.</span> <span class="toc-text">
          4. Experiments</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#font-faceadobe-caslon-pro41-datasets-and-backbone-architecturesfont"><span class="toc-number">5.1.</span> <span class="toc-text">
          4.1. Datasets and backbone architectures</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#font-faceadobe-caslon-pro42-task-incremental-settingfont"><span class="toc-number">5.2.</span> <span class="toc-text">
          4.2 Task-incremental setting</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#font-faceadobe-caslon-pro43-classincremental-with-episodic-memoryfont"><span class="toc-number">5.3.</span> <span class="toc-text">
          4.3. Classincremental with episodic memory</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#font-faceadobe-caslon-pro44-classincremental-with-generative-memoryfont"><span class="toc-number">5.4.</span> <span class="toc-text">
          4.4. Classincremental with generative memory</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#font-faceadobe-caslon-pro45-model-analysisfont"><span class="toc-number">5.5.</span> <span class="toc-text">
          4.5. Model analysis</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#font-faceadobe-caslon-pro5-conclusionsfont"><span class="toc-number">6.</span> <span class="toc-text">
          5. Conclusions</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#font-faceadobe-caslon-pro%E4%BC%98%E7%82%B9font"><span class="toc-number">7.</span> <span class="toc-text">
          优点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#font-faceadobe-caslon-pro%E7%BC%BA%E7%82%B9font"><span class="toc-number">8.</span> <span class="toc-text">
          缺点</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#font-faceadobe-caslon-pro%E5%90%AF%E5%8F%91font"><span class="toc-number">9.</span> <span class="toc-text">
          启发</span></a></li></ol></section><!-- ov = overview--><section class="sidebar-ov hide"><div class="sidebar-ov-author"><div class="sidebar-ov-author__avatar"><img class="sidebar-ov-author__avatar_img" src="/assets/avatar/avatar.png" alt="avatar"></div></div><div class="sidebar-ov-social"><a class="sidebar-ov-social-item" href="mailto:ly_liuyang19@qq.com" target="_blank" rel="noopener" data-popover="social.mail" data-popover-pos="up"><span class="sidebar-ov-social-item__icon">Email</span></a></div><div class="sidebar-ov-state"><a class="sidebar-ov-state-item sidebar-ov-state-item--posts" href="/archives/"><div class="sidebar-ov-state-item__count">44</div><div class="sidebar-ov-state-item__name">Archives</div></a><a class="sidebar-ov-state-item sidebar-ov-state-item--tags" href="/tags/"><div class="sidebar-ov-state-item__count">18</div><div class="sidebar-ov-state-item__name">Tags</div></a></div><div class="sidebar-ov-cc"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.en" target="_blank" rel="noopener" data-popover="Creative Commons" data-popover-pos="up"><img src="/images/cc-by-nc-sa.svg"></a></div></section><div class="sidebar-reading"><div class="sidebar-reading-info"><span class="sidebar-reading-info__text">You have read </span><span class="sidebar-reading-info__num">0</span><span class="sidebar-reading-info__perc">%</span></div><div class="sidebar-reading-line"></div></div></aside></div><div class="clearfix"></div></div></main><footer class="footer" id="footer"><div class="footer-inner"><div><span>Copyright © 2021</span><span class="footer__icon"><i class="fas fa-heart"></i></span><span>liuyang-70d12d</span></div><div><span>Powered by <a href="http://hexo.io/" title="Hexo" target="_blank" rel="noopener">Hexo</a></span><span> v5.2.0</span><span class="footer__devider">|</span><span>Theme - <a href="https://github.com/liuyib/hexo-theme-stun/" title="Stun" target="_blank" rel="noopener">Stun</a></span><span> v2.3.0</span></div><div class="busuanzi"><span class="busuanzi-siteuv"><span class="busuanzi-siteuv__icon"><i class="fas fa-user"></i></span><span class="busuanzi-siteuv__info">Visitors</span><span class="busuanzi-siteuv__value" id="busuanzi_value_site_uv"></span></span><span class="busuanzi-sitepv"><span class="busuanzi-siteuv__icon"><i class="fas fa-eye"></i></span><span class="busuanzi-siteuv__info">Views</span><span class="busuanzi-siteuv__value" id="busuanzi_value_site_pv"></span></span></div><div><span id="timeDate">载入天数...</span><span id="times">载入时分秒...</span><script>var now = new Date();
function createtime() {
var grt= new Date("11/09/2020 00:00:00");
now.setTime(now.getTime()+250);
days = (now - grt ) / 1000 / 60 / 60 / 24; dnum = Math.floor(days);
hours = (now - grt ) / 1000 / 60 / 60 - (24 * dnum); hnum = Math.floor(hours);
if(String(hnum).length ==1 ){hnum = "0" + hnum;} minutes = (now - grt ) / 1000 /60 - (24 * 60 * dnum) - (60 * hnum);
mnum = Math.floor(minutes); if(String(mnum).length ==1 ){mnum = "0" + mnum;}
seconds = (now - grt ) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
snum = Math.round(seconds); if(String(snum).length ==1 ){snum = "0" + snum;}
document.getElementById("timeDate").innerHTML = "我已来到这个世界 "+dnum+" 天 ";
document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒";
}
setInterval("createtime()",250);</script></div></div></footer><div class="loading-bar" id="loading-bar"><div class="loading-bar__progress"></div></div><div class="back2top" id="back2top"><span class="back2top__icon"><i class="fas fa-rocket"></i></span></div></div><script src="https://cdn.jsdelivr.net/npm/jquery@v3.4.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.ui.min.js"></script><link href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css" rel="stylesheet" type="text/css"><link href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/contrib/copy-tex.css" rel="stylesheet" type="text/css"><script src="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/contrib/copy-tex.min.js"></script><script src="https://cdn.jsdelivr.net/gh/sukkaw/busuanzi@latest/bsz.pure.mini.js" async></script><script src="/js/utils.js?v=2.3.0"></script><script src="/js/stun-boot.js?v=2.3.0"></script><script src="/js/scroll.js?v=2.3.0"></script><script src="/js/header.js?v=2.3.0"></script><script src="/js/sidebar.js?v=2.3.0"></script></body></html>